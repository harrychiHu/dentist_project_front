import{V as h,r as w,B as D,o as R,c as $,a,b as o,C as b,w as s,L as _,S as c,bg as j,bh as O,N as p,k as Z,ar as G,bn as I,bi as L,bj as W,A as m}from"./index.0639ca9c.js";import{_ as H}from"./DataTable.0f1d4003.js";import{_ as J}from"./Upload.01a89e39.js";import{_ as K}from"./Switch.155298fe.js";import{N as y}from"./GradientText.69ec6ccb.js";import"./get-slot.65c4337d.js";import"./Select.76561d36.js";const P={id:"DoctorSetting"},Q=a("h1",null,"\u91AB\u5E2B\u7BA1\u7406",-1),X=a("div",{class:"editorButton"},[a("a",{href:"#admin/admin-doctor-editor-setting"},[a("button",{type:"submit",class:"create_btn"},"\u65B0\u589E")])],-1),Y={class:"doctorFormContent"},ee=Z("\u4E0A\u50B3\u91AB\u5E2B\u7167\u7247"),te={style:{display:"flex","justify-content":"flex-end"},class:"submitButton"},ne={href:"#admin/admin-doctor-setting"},oe=a("button",{type:"submit",class:"saveBtnDOC"},"\u4FDD\u5B58",-1),me={__name:"AdminDoctorSettingView",setup(re){const x=h("medium"),k=h(null),E={width:"600px"},t=w({_id:"",name:"",image:[],description:"",online:!1,idx:-1,show:!1,showModal:!1}),B=(n,e)=>{t._id=n,e>-1?(t.name=l[e].name,t.image=l[e].image,t.description=l[e].description,t.online=l[e].online):(t.name="",t.online=!1,t.description=""),t.showModal=!0,t.image=[],t.idx},z=()=>[{title:"\u91AB\u751F\u540D\u5B57",key:"name"},{title:"\u4E0A\u7DDA",key:"online",render(n){return n.online===!1?m(y,{type:"danger",size:"small"},{default:()=>"\u672A\u4E0A\u7DDA"}):m(y,{type:"info",size:"small"},{default:()=>"\u4E0A\u7DDA"})}},{title:"\u7DE8\u8F2F",key:"editor",render(n){return m(p,{strong:!0,tertiary:!0,size:"small",class:"bg-editor",onClick:()=>B(n._id,n.idx)},{default:()=>"\u7DE8\u8F2F"})}},{title:"\u522A\u9664",key:"del",render(n){return m(p,{strong:!0,tertiary:!0,size:"small",class:"bg-del",onClick:()=>A(n._id)},{default:()=>"\u522A\u9664"})}}],l=w([]),f=({focused:n,checked:e})=>{const r={};return e?(r.background="#2473cb",n&&(r.boxShadow="0 0 0 2px #2169BA")):(r.background="#959595",n&&(r.boxShadow="0 0 0 2px #595959")),r},v={name:{required:!0,trigger:["blur","input"],validator(n,e){if(e)if(/^[\u4E00-\u9FA5A-Za-z\s]+(Â·[\u4E00-\u9FA5A-Za-z]+)*$/.test(e)){if(e.length<=1)return new Error("\u5B57\u6578\u4E0D\u80FD\u5C11\u65BC2");if(e.length>=10)return new Error("\u5B57\u6578\u4E0D\u80FD\u591A\u65BC10")}else return new Error("\u540D\u5B57\u683C\u5F0F\u932F\u8AA4");else return new Error("\u9700\u8981\u540D\u5B57");return!0}},description:{required:!0,trigger:["blur","input"],validator(n,e){if(e){if(e.length<=9)return new Error("\u5B57\u6578\u4E0D\u80FD\u5C11\u65BC10");if(e.length>=99)return new Error("\u5B57\u6578\u4E0D\u80FD\u591A\u65BC100")}else return new Error("\u9700\u8981\u63CF\u8FF0");return!0}},image:{required:!0,validator(n,e){var r,u,d;if(e){if(!e.length||((u=(r=e[0])==null?void 0:r.type)==null?void 0:u.includes("image"))&&((d=e[0])==null?void 0:d.size)<1024*1024)return new Error("\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26")}else return new Error("\u9700\u8981\u5716\u7247");return!0}}},C=async()=>{t.show=!0;const n=new FormData;for(const e in t)["_id","idx","show"].includes(e)||(e==="image"?t.image.length>0&&n.append(e,t[e][0].file):n.append(e,t[e]));try{const{data:e}=await _.patch("/doctors/"+t._id,n);l[t.idx]=e.result,c.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),t.showModal=!1}catch(e){c.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message}),t.showModal=!1}t.show=!1},A=n=>{c.fire({title:"\u78BA\u5B9A\u522A\u9664\u55CE?",text:"\u522A\u9664\u5F8C\u7121\u6CD5\u56DE\u5FA9!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\u5C0D\uFF0C\u522A\u9664!",cancelButtonText:"\u53D6\u6D88!"}).then(async e=>{e.isConfirmed&&(await _.delete("/doctors/"+n),c.fire("\u522A\u9664\u6210\u529F","\u6210\u529F")),g()}).catch(e=>{c.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})})},g=async()=>{let n=0;try{const{data:e}=await _.get("./doctors/all");l.push(...e.result),l.forEach(r=>{r.idx=n++})}catch(e){c.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}};g();const S={pageSize:8},M=z();return(n,e)=>{const r=H,u=G,d=I,N=J,F=D,T=K,U=L,V=W,q=j;return R(),$("section",P,[Q,X,a("div",Y,[a("div",null,[o(r,{columns:b(M),data:l,pagination:S,bordered:!1},null,8,["columns","data"])])]),o(q,{show:t.showModal,"onUpdate:show":e[4]||(e[4]=i=>t.showModal=i),class:"editCard",preset:"card",style:E,title:"\u7DE8\u8F2F\u91AB\u5E2B\u8868\u55AE",size:"huge",bordered:!1},{default:s(()=>[o(V,{class:"doctorForm",ref_key:"formRef",ref:k,model:t,rules:v,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging",size:x.value,style:{maxWidth:"1000px"},onSubmit:O(C,["prevent"])},{default:s(()=>[o(d,{label:"\u91AB\u5E2B\u59D3\u540D",path:"name"},{default:s(()=>[o(u,{value:t.name,"onUpdate:value":e[0]||(e[0]=i=>t.name=i),placeholder:"\u8ACB\u8F38\u5165\u91AB\u5E2B\u59D3\u540D"},null,8,["value"])]),_:1}),o(d,{label:"\u91AB\u5E2B\u7167\u7247",path:"image"},{default:s(()=>[o(N,{"file-list":t.image,"onUpdate:file-list":e[1]||(e[1]=i=>t.image=i),accept:"image/*",max:1},{default:s(()=>[o(b(p),null,{default:s(()=>[ee]),_:1})]),_:1},8,["file-list"])]),_:1}),o(d,{label:"\u91AB\u5E2B\u4ECB\u7D39",path:"description"},{"clear-icon":s(()=>[o(F,{component:n.TrashBinOutline},null,8,["component"])]),default:s(()=>[o(u,{value:t.description,"onUpdate:value":e[2]||(e[2]=i=>t.description=i),placeholder:"Textarea",type:"textarea",round:"",clearable:"",autosize:{minRows:3}},null,8,["value"])]),_:1}),o(d,{"rail-style":f,label:"\u662F\u5426\u4E0A\u7DDA",path:"online"},{default:s(()=>[o(T,{"rail-style":f,value:t.online,"onUpdate:value":e[3]||(e[3]=i=>t.online=i)},{checked:s(()=>[]),unchecked:s(()=>[]),_:1},8,["value"])]),_:1}),a("div",te,[a("a",ne,[o(U,{show:t.show},{default:s(()=>[oe]),_:1},8,["show"])])])]),_:1},8,["model","size","onSubmit"])]),_:1},8,["show"])])}}};export{me as default};
