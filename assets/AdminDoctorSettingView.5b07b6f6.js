import{a3 as h,r as g,C as q,o as V,c as R,a as i,b as r,D as w,w as n,n as m,S as d,bh as $,bi as j,N as p,k as y,ah as O,bj as Z,bk as G,bl as I,B as _}from"./index.ac68fa86.js";import{_ as W}from"./DataTable.bfc26a39.js";import{_ as Y}from"./Upload.e6e6d221.js";import{_ as H}from"./Checkbox.bf343829.js";import{N as b}from"./GradientText.cd004acd.js";import"./Select.9f82364d.js";const J={id:"DoctorSetting"},K=i("h1",null,"\u91AB\u5E2B\u7BA1\u7406",-1),L=i("div",{class:"editorButton"},[i("a",{href:"#admin/admin-doctor-editor-setting"},[i("button",{type:"submit",class:"create_btn"},"\u65B0\u589E")])],-1),Q={class:"doctorFormContent"},X=y("\u4E0A\u50B3\u91AB\u5E2B\u7167\u7247"),ee=y(" \u4E0A\u7DDA "),te={style:{display:"flex","justify-content":"flex-end"},class:"submitButton"},oe={href:"#admin/admin-doctor-setting"},re=i("button",{type:"submit",class:"saveBtnDOC"},"\u4FDD\u5B58",-1),ue={__name:"AdminDoctorSettingView",setup(ne){const x=h("medium"),k=h(null),E={width:"600px"},t=g({_id:"",doctorName:"",doctorPic:[],doctorDescription:"",doctorShow:!1,idx:-1,show:!1,showModal:!1}),N=(o,e)=>{t._id=o,e>-1&&(t.doctorName=a[e].doctorName,t.doctorPic=a[e].doctorPic,t.doctorDescription=a[e].doctorDescription,t.doctorShow=a[e].doctorShow),t.showModal=!0,t.doctorPic=[],t.idx},S=()=>[{title:"\u91AB\u751F\u540D\u5B57",key:"doctorName"},{title:"\u4E0A\u7DDA",key:"doctorShow",render(o){return o.doctorShow===!1?_(b,{type:"danger",size:"small"},{default:()=>"\u672A\u4E0A\u7DDA"}):_(b,{type:"info",size:"small"},{default:()=>"\u4E0A\u7DDA"})}},{title:"\u7DE8\u8F2F",key:"editor",render(o){return _(p,{strong:!0,tertiary:!0,size:"small",class:"bg-editor",onClick:()=>N(o._id,o.idx)},{default:()=>"\u7DE8\u8F2F"})}},{title:"\u522A\u9664",key:"del",render(o){return _(p,{strong:!0,tertiary:!0,size:"small",class:"bg-del",onClick:()=>D(o._id)},{default:()=>"\u522A\u9664"})}}],a=g([]),B={doctorName:{required:!0,trigger:["blur","input"],validator(o,e){if(e)if(/^[\u4E00-\u9FA5A-Za-z\s]+(Â·[\u4E00-\u9FA5A-Za-z]+)*$/.test(e)){if(e.length<=1)return new Error("\u5B57\u6578\u4E0D\u80FD\u5C11\u65BC2");if(e.length>=10)return new Error("\u5B57\u6578\u4E0D\u80FD\u591A\u65BC10")}else return new Error("\u540D\u5B57\u683C\u5F0F\u932F\u8AA4");else return new Error("\u9700\u8981\u540D\u5B57");return!0}},doctorDescription:{required:!0,trigger:["blur","input"],validator(o,e){if(e){if(e.length<=9)return new Error("\u5B57\u6578\u4E0D\u80FD\u5C11\u65BC10");if(e.length>=99)return new Error("\u5B57\u6578\u4E0D\u80FD\u591A\u65BC100")}else return new Error("\u9700\u8981\u63CF\u8FF0");return!0}},doctorPic:{required:!0,validator(o,e){var c,u,l;if(e){if(!e.length||((u=(c=e[0])==null?void 0:c.type)==null?void 0:u.includes("image"))&&((l=e[0])==null?void 0:l.size)<1024*1024)return new Error("\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26")}else return new Error("\u9700\u8981\u5716\u7247");return!0}}},z=async()=>{t.show=!0;const o=new FormData;for(const e in t)["_id","idx","show"].includes(e)||(e==="doctorPic"?t.doctorPic.length>0&&o.append(e,t[e][0].file):o.append(e,t[e]));try{const{data:e}=await m.patch("/doctors/"+t._id,o);a[t.idx]=e.result,d.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),t.showModal=!1}catch(e){d.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message}),t.showModal=!1}t.show=!1},D=o=>{d.fire({title:"\u78BA\u5B9A\u522A\u9664\u55CE?",text:"\u522A\u9664\u5F8C\u7121\u6CD5\u56DE\u5FA9!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\u5C0D\uFF0C\u522A\u9664!",cancelButtonText:"\u53D6\u6D88!"}).then(async e=>{e.isConfirmed&&(await m.delete("/doctors/"+o),d.fire("Deleted!","Your file has been deleted.","success")),f()}).catch(e=>{d.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})})},f=async()=>{let o=0;try{const{data:e}=await m.get("./doctors/all");a.push(...e.result),a.forEach(c=>{c.idx=o++})}catch(e){d.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}};f();const C={pageSize:5},P=S();return(o,e)=>{const c=W,u=O,l=Z,v=Y,A=q,M=H,F=G,T=I,U=$;return V(),R("section",J,[K,L,i("div",Q,[i("div",null,[r(c,{columns:w(P),data:a,pagination:C,bordered:!1},null,8,["columns","data"])])]),r(U,{show:t.showModal,"onUpdate:show":e[4]||(e[4]=s=>t.showModal=s),class:"editCard",preset:"card",style:E,title:"\u7DE8\u8F2F\u91AB\u5E2B\u8868\u55AE",size:"huge",bordered:!1,segmented:o.segmented},{default:n(()=>[r(T,{class:"doctorForm",ref_key:"formRef",ref:k,model:t,rules:B,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging",size:x.value,style:{maxWidth:"1000px"},onSubmit:j(z,["prevent"])},{default:n(()=>[r(l,{label:"\u91AB\u5E2B\u59D3\u540D",path:"doctorName"},{default:n(()=>[r(u,{value:t.doctorName,"onUpdate:value":e[0]||(e[0]=s=>t.doctorName=s),placeholder:"\u8ACB\u8F38\u5165\u91AB\u5E2B\u59D3\u540D"},null,8,["value"])]),_:1}),r(l,{label:"\u91AB\u5E2B\u7167\u7247",path:"doctorPic"},{default:n(()=>[r(v,{"file-list":t.doctorPic,"onUpdate:file-list":e[1]||(e[1]=s=>t.doctorPic=s),accept:"image/*"},{default:n(()=>[r(w(p),null,{default:n(()=>[X]),_:1})]),_:1},8,["file-list"])]),_:1}),r(l,{label:"\u91AB\u5E2B\u4ECB\u7D39",path:"doctorDescription"},{"clear-icon":n(()=>[r(A,{component:o.TrashBinOutline},null,8,["component"])]),default:n(()=>[r(u,{value:t.doctorDescription,"onUpdate:value":e[2]||(e[2]=s=>t.doctorDescription=s),placeholder:"Textarea",type:"textarea",round:"",clearable:"",autosize:{minRows:3}},null,8,["value"])]),_:1}),r(l,{label:"\u662F\u5426\u4E0A\u7DDA",path:"doctorShow"},{default:n(()=>[r(M,{checked:t.doctorShow,"onUpdate:checked":e[3]||(e[3]=s=>t.doctorShow=s)},{default:n(()=>[ee]),_:1},8,["checked"])]),_:1}),i("div",te,[i("a",oe,[r(F,{show:t.show},{default:n(()=>[re]),_:1},8,["show"])])])]),_:1},8,["model","size","onSubmit"])]),_:1},8,["show","segmented"])])}}};export{ue as default};
