import{W as y,r as b,C as j,o as Q,c as W,a as c,b as a,D as _,w as i,n as m,S as u,bh as Z,bi as G,N as f,k as I,as as O,bj as H,bk as J,B as p}from"./index.0206a6d8.js";import{Q as K,_ as L,a as X}from"./vue-quill.esm-bundler.0203a4ae.js";import{_ as Y}from"./Select.0227e0ad.js";import{_ as ee}from"./DatePicker.3dc6543e.js";import{_ as te}from"./Switch.947f57e1.js";import{_ as re}from"./Upload.ccd5b5db.js";import{N as x}from"./GradientText.e7c04400.js";import{_ as ae}from"./DataTable.d6760624.js";import"./get-slot.65c4337d.js";const ie={id:"ArticleSetting"},le=c("h1",null,"\u6587\u7AE0\u7BA1\u7406",-1),ne=c("div",{class:"editorButton"},[c("a",{href:"#admin/admin-article-editor-setting"},[c("button",{type:"submit",class:"create_btn"},"\u65B0\u589E")])],-1),oe={class:"articleFormContent"},se=I("\u4E0A\u50B3\u6587\u7AE0\u5716\u7247"),ce={style:{display:"flex","justify-content":"flex-end"},class:"submitButton"},ue={href:"#admin/admin-article-setting"},de=c("button",{type:"submit",class:"saveBtnART"},"\u4FDD\u5B58",-1),ve={__name:"AdminArticleSettingView",setup(pe){const v=y("medium"),E=y(null),k={width:"800px"},t=b({_id:"",articleTitle:"",articleDate:Date.now(),articlePic:[],articleDescription:"",articleShow:!1,idx:-1,show:!1,showModal:!1,articleEditor:"",articleCategory:""}),C=(r,e)=>{t._id=r,e>-1&&(t.articleTitle=o[e].articleTitle,t.articlePic=o[e].articlePic,t.articleDescription=o[e].articleDescription,t.articleShow=o[e].articleShow,t.articleEditor=o[e].articleEditor,t.articleCategory=o[e].articleCategory,t.articleDate=o[e].articleDate),t.showModal=!0,t.articlePic=[],t.idx,t.articleDate=Date.now()},D=()=>[{title:"\u6587\u7AE0\u6A19\u984C",key:"articleTitle"},{title:"\u4E0A\u67B6",key:"articleShow",render(r){return r.articleShow===!1?p(x,{type:"danger",size:"small"},{default:()=>"\u672A\u4E0A\u67B6"}):p(x,{type:"info",size:"small"},{default:()=>"\u4E0A\u67B6"})}},{title:"\u7DE8\u8F2F",key:"editor",render(r){return p(f,{strong:!0,tertiary:!0,size:"small",class:"bg-editor",onClick:()=>C(r._id,r.idx)},{default:()=>"\u7DE8\u8F2F"})}},{title:"\u522A\u9664",key:"del",render(r){return p(f,{strong:!0,tertiary:!0,size:"small",class:"bg-del",onClick:()=>z(r._id)},{default:()=>"\u522A\u9664"})}}],o=b([]),h=({focused:r,checked:e})=>{const n={};return e?(n.background="#2473cb",r&&(n.boxShadow="0 0 0 2px #2169BA")):(n.background="#959595",r&&(n.boxShadow="0 0 0 2px #595959")),n},S={articleTitle:{required:!0,trigger:["blur","input"],validator(r,e){if(e)if(/^[\u4E00-\u9FA5A-Za-z\s]+(Â·[\u4E00-\u9FA5A-Za-z]+)*$/.test(e)){if(e.length<=1)return new Error("\u5B57\u6578\u4E0D\u80FD\u5C11\u65BC2");if(e.length>=10)return new Error("\u5B57\u6578\u4E0D\u80FD\u591A\u65BC10")}else return new Error("\u6A19\u984C\u683C\u5F0F\u932F\u8AA4");else return new Error("\u9700\u8981\u6A19\u984C");return!0}},articleDescription:{required:!0,trigger:["blur","input"],validator(r,e){if(e){if(e.length<=9)return new Error("\u5B57\u6578\u4E0D\u80FD\u5C11\u65BC10");if(e.length>=99)return new Error("\u5B57\u6578\u4E0D\u80FD\u591A\u65BC100")}else return new Error("\u9700\u8981\u63CF\u8FF0");return!0}},articlePic:{required:!0,validator(r,e){var n,d,s;if(e){if(!e.length||((d=(n=e[0])==null?void 0:n.type)==null?void 0:d.includes("image"))&&((s=e[0])==null?void 0:s.size)<1024*1024)return new Error("\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26")}else return new Error("\u9700\u8981\u5716\u7247");return!0}},articleEditor:{required:!0},articleCategory:{required:!0},articleDate:{required:!0}},T=[{label:"\u9F52\u984E\u77EF\u6B63",key:"orthodontics",value:"\u9F52\u984E\u77EF\u6B63"},{label:"\u4EBA\u5DE5\u690D\u7259",key:"dental implant",value:"\u4EBA\u5DE5\u690D\u7259"},{label:"\u7F8E\u5BB9\u7259\u79D1",key:"aesthetic",value:"\u7F8E\u5BB9\u7259\u79D1"},{label:"\u5BB6\u5EAD\u7259\u79D1",key:"family dentistry division",value:"\u5BB6\u5EAD\u7259\u79D1"}],B=async()=>{t.show=!0;const r=new FormData;for(const e in t)["_id","idx","show"].includes(e)||(e==="articlePic"?t.articlePic.length>0&&r.append(e,t[e][0].file):r.append(e,t[e]));try{const{data:e}=await m.patch("/articles/"+t._id,r);o[t.idx]=e.result,u.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),t.showModal=!1}catch(e){u.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message}),t.showModal=!1}t.show=!1},z=r=>{u.fire({title:"\u78BA\u5B9A\u522A\u9664\u55CE?",text:"\u522A\u9664\u5F8C\u7121\u6CD5\u56DE\u5FA9!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\u5C0D\uFF0C\u522A\u9664!",cancelButtonText:"\u53D6\u6D88!"}).then(async e=>{e.isConfirmed&&(await m.delete("/articles/"+r),u.fire("\u522A\u9664\u6210\u529F","\u6210\u529F")),g()}).catch(e=>{u.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})})},g=async()=>{try{let r=0;const{data:e}=await m.get("./articles/all");o.push(...e.result),o.forEach(n=>{n.idx=r++})}catch(r){u.fire({icon:"error",title:"\u5931\u6557",text:r.isAxiosError?r.response.data.message:r.message})}};g();const A={pageSize:8},P=D();return(r,e)=>{const n=ae,d=Y,s=L,w=O,M=ee,N=te,U=re,q=j,F=X,R=H,V=J,$=Z;return Q(),W("section",ie,[le,ne,c("div",oe,[c("div",null,[a(n,{columns:_(P),data:o,pagination:A,bordered:!1},null,8,["columns","data"])])]),a($,{show:t.showModal,"onUpdate:show":e[7]||(e[7]=l=>t.showModal=l),class:"editCard",preset:"card",style:k,title:"\u7DE8\u8F2F\u6587\u7AE0\u8868\u55AE",size:"huge",bordered:!1},{default:i(()=>[a(V,{class:"articleForm",ref_key:"formRef",ref:E,model:t,rules:S,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging",size:v.value,style:{maxWidth:"1000px"},onSubmit:G(B,["prevent"])},{default:i(()=>[a(F,{cols:24,"x-gap":24},{default:i(()=>[a(s,{span:24,label:"\u9078\u64C7\u5206\u985E",path:"articleCategory"},{default:i(()=>[a(d,{value:t.articleCategory,"onUpdate:value":e[0]||(e[0]=l=>t.articleCategory=l),options:T,placeholder:"\u9078\u64C7\u5206\u985E"},null,8,["value"])]),_:1}),a(s,{span:24,label:"\u6587\u7AE0\u6A19\u984C",path:"articleTitle"},{default:i(()=>[a(w,{value:t.articleTitle,"onUpdate:value":e[1]||(e[1]=l=>t.articleTitle=l),placeholder:"\u8ACB\u8F38\u5165\u6587\u7AE0\u6A19\u984C"},null,8,["value"])]),_:1}),a(s,{span:12,label:"\u6587\u7AE0\u65E5\u671F",path:"articleDate"},{default:i(()=>[a(M,{value:t.articleDate,"onUpdate:value":e[2]||(e[2]=l=>t.articleDate=l),type:"datetime",clearable:""},null,8,["value"])]),_:1}),a(s,{span:12,"rail-style":h,label:"\u662F\u5426\u4E0A\u67B6",path:"articleShow"},{default:i(()=>[a(N,{"rail-style":h,value:t.articleShow,"onUpdate:value":e[3]||(e[3]=l=>t.articleShow=l)},{checked:i(()=>[]),unchecked:i(()=>[]),_:1},8,["value"])]),_:1}),a(s,{span:24,label:"\u6587\u7AE0\u5716\u7247",path:"articlePic"},{default:i(()=>[a(U,{"file-list":t.articlePic,"onUpdate:file-list":e[4]||(e[4]=l=>t.articlePic=l),accept:"image/*"},{default:i(()=>[a(_(f),null,{default:i(()=>[se]),_:1})]),_:1},8,["file-list"])]),_:1}),a(s,{span:24,label:"\u6587\u7AE0\u63CF\u8FF0",path:"articleDescription"},{"clear-icon":i(()=>[a(q,{component:r.TrashBinOutline},null,8,["component"])]),default:i(()=>[a(w,{value:t.articleDescription,"onUpdate:value":e[5]||(e[5]=l=>t.articleDescription=l),placeholder:"Textarea",type:"textarea",round:"",clearable:"",autosize:{minRows:3}},null,8,["value"])]),_:1}),a(s,{span:24,label:"\u6587\u7AE0\u5167\u5BB9",path:"articleEditor"},{default:i(()=>[c("div",null,[a(_(K),{toolbar:"full",content:t.articleEditor,"onUpdate:content":e[6]||(e[6]=l=>t.articleEditor=l),contentType:"html"},null,8,["content"])])]),_:1})]),_:1}),c("div",ce,[c("a",ue,[a(R,{show:t.show},{default:i(()=>[de]),_:1},8,["show"])])])]),_:1},8,["model","size","onSubmit"])]),_:1},8,["show"])])}}};export{ve as default};
