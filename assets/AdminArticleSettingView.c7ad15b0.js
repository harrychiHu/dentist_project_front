import{V as b,r as w,B as Q,o as Z,c as G,a as u,b as o,C as _,w as r,L as m,S as d,bg as I,bh as L,N as f,k as O,ar as W,bi as H,bj as J,A as p}from"./index.0639ca9c.js";import{Q as K,_ as P,a as X}from"./vue-quill.esm-bundler.3c56d96f.js";import{_ as Y}from"./Select.76561d36.js";import{_ as ee}from"./DatePicker.4a482eb4.js";import{_ as te}from"./Switch.155298fe.js";import{_ as ne}from"./Upload.01a89e39.js";import{N as x}from"./GradientText.69ec6ccb.js";import{_ as oe}from"./DataTable.0f1d4003.js";import"./get-slot.65c4337d.js";const re={id:"ArticleSetting"},ae=u("h1",null,"\u6587\u7AE0\u7BA1\u7406",-1),le=u("div",{class:"editorButton"},[u("a",{href:"#admin/admin-article-editor-setting"},[u("button",{type:"submit",class:"create_btn"},"\u65B0\u589E")])],-1),ie={class:"articleFormContent"},se=O("\u4E0A\u50B3\u6587\u7AE0\u5716\u7247"),ue={style:{display:"flex","justify-content":"flex-end"},class:"submitButton"},de={href:"#admin/admin-article-setting"},ce=u("button",{type:"submit",class:"saveBtnART"},"\u4FDD\u5B58",-1),ve={__name:"AdminArticleSettingView",setup(pe){const v=b("medium"),k=b(null),E={width:"800px"},t=w({_id:"",title:"",date:Date.now(),image:[],description:"",online:!1,idx:-1,show:!1,showModal:!1,editor:"",category:""}),B=(n,e)=>{t._id=n,e>-1?(t.title=i[e].title,t.description=i[e].description,t.online=i[e].online,t.editor=i[e].editor,t.category=i[e].category,t.date=i[e].date):(t.title="",t.category="",t.online=!1,t.description="",t.editor=""),t.showModal=!0,t.image=[],t.idx,t.date=Date.now()},A=()=>[{title:"\u6587\u7AE0\u6A19\u984C",key:"title"},{title:"\u4E0A\u67B6",key:"online",render(n){return n.online===!1?p(x,{type:"danger",size:"small"},{default:()=>"\u672A\u4E0A\u67B6"}):p(x,{type:"info",size:"small"},{default:()=>"\u4E0A\u67B6"})}},{title:"\u7DE8\u8F2F",key:"editor",render(n){return p(f,{strong:!0,tertiary:!0,size:"small",class:"bg-editor",onClick:()=>B(n._id,n.idx)},{default:()=>"\u7DE8\u8F2F"})}},{title:"\u522A\u9664",key:"del",render(n){return p(f,{strong:!0,tertiary:!0,size:"small",class:"bg-del",onClick:()=>M(n._id)},{default:()=>"\u522A\u9664"})}}],i=w([]),g=({focused:n,checked:e})=>{const l={};return e?(l.background="#2473cb",n&&(l.boxShadow="0 0 0 2px #2169BA")):(l.background="#959595",n&&(l.boxShadow="0 0 0 2px #595959")),l},z={title:{required:!0,trigger:["blur","input"],validator(n,e){if(e)if(/^[\u4E00-\u9FA5A-Za-z\s]+(Â·[\u4E00-\u9FA5A-Za-z]+)*$/.test(e)){if(e.length<=1)return new Error("\u5B57\u6578\u4E0D\u80FD\u5C11\u65BC2");if(e.length>=10)return new Error("\u5B57\u6578\u4E0D\u80FD\u591A\u65BC10")}else return new Error("\u6A19\u984C\u683C\u5F0F\u932F\u8AA4");else return new Error("\u9700\u8981\u6A19\u984C");return!0}},description:{required:!0,trigger:["blur","input"],validator(n,e){if(e){if(e.length<=9)return new Error("\u5B57\u6578\u4E0D\u80FD\u5C11\u65BC10");if(e.length>=99)return new Error("\u5B57\u6578\u4E0D\u80FD\u591A\u65BC100")}else return new Error("\u9700\u8981\u63CF\u8FF0");return!0}},image:{required:!0,validator(n,e){var l,c,s;if(e){if(!e.length||((c=(l=e[0])==null?void 0:l.type)==null?void 0:c.includes("image"))&&((s=e[0])==null?void 0:s.size)<1024*1024)return new Error("\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26")}else return new Error("\u9700\u8981\u5716\u7247");return!0}},editor:{required:!0},category:{required:!0},date:{required:!0}},C=[{label:"\u53E3\u8154\u4FDD\u5065",key:"oral hygiene",value:"\u53E3\u8154\u4FDD\u5065"},{label:"\u7259\u9F52\u77EF\u6B63",key:"orthodontics",value:"\u7259\u9F52\u77EF\u6B63"},{label:"\u7259\u9F52\u7F8E\u5BB9",key:"dental beauty",value:"\u7259\u9F52\u7F8E\u5BB9"},{label:"\u98DF\u8B5C\u4FDD\u5065",key:"recipe health",value:"\u98DF\u8B5C\u4FDD\u5065"}],S=async()=>{t.show=!0;const n=new FormData;for(const e in t)["_id","idx","show"].includes(e)||(e==="image"?t.image.length>0&&n.append(e,t[e][0].file):n.append(e,t[e]));try{const{data:e}=await m.patch("/articles/"+t._id,n);console.log(n),i[t.idx]=e.result,d.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),t.showModal=!1}catch(e){d.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message}),t.showModal=!1}t.show=!1},M=n=>{d.fire({title:"\u78BA\u5B9A\u522A\u9664\u55CE?",text:"\u522A\u9664\u5F8C\u7121\u6CD5\u56DE\u5FA9!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\u5C0D\uFF0C\u522A\u9664!",cancelButtonText:"\u53D6\u6D88!"}).then(async e=>{e.isConfirmed&&(await m.delete("/articles/"+n),d.fire("\u522A\u9664\u6210\u529F","\u6210\u529F")),h()}).catch(e=>{d.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})})},h=async()=>{try{let n=0;const{data:e}=await m.get("./articles/all");i.push(...e.result),i.forEach(l=>{l.idx=n++})}catch(n){d.fire({icon:"error",title:"\u5931\u6557",text:n.isAxiosError?n.response.data.message:n.message})}};h();const N={pageSize:8},T=A();return(n,e)=>{const l=oe,c=Y,s=P,y=W,U=ee,q=te,F=ne,V=Q,R=X,$=H,D=J,j=I;return Z(),G("section",re,[ae,le,u("div",ie,[u("div",null,[o(l,{columns:_(T),data:i,pagination:N,bordered:!1},null,8,["columns","data"])])]),o(j,{show:t.showModal,"onUpdate:show":e[7]||(e[7]=a=>t.showModal=a),class:"editCard",preset:"card",style:E,title:"\u7DE8\u8F2F\u6587\u7AE0\u8868\u55AE",size:"huge",bordered:!1},{default:r(()=>[o(D,{class:"articleForm",ref_key:"formRef",ref:k,model:t,rules:z,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging",size:v.value,style:{maxWidth:"1000px"},onSubmit:L(S,["prevent"])},{default:r(()=>[o(R,{cols:24,"x-gap":24},{default:r(()=>[o(s,{span:24,label:"\u9078\u64C7\u5206\u985E",path:"category"},{default:r(()=>[o(c,{value:t.category,"onUpdate:value":e[0]||(e[0]=a=>t.category=a),options:C,placeholder:"\u9078\u64C7\u5206\u985E"},null,8,["value"])]),_:1}),o(s,{span:24,label:"\u6587\u7AE0\u6A19\u984C",path:"title"},{default:r(()=>[o(y,{value:t.title,"onUpdate:value":e[1]||(e[1]=a=>t.title=a),placeholder:"\u8ACB\u8F38\u5165\u6587\u7AE0\u6A19\u984C"},null,8,["value"])]),_:1}),o(s,{span:12,label:"\u6587\u7AE0\u65E5\u671F",path:"date"},{default:r(()=>[o(U,{value:t.date,"onUpdate:value":e[2]||(e[2]=a=>t.date=a),type:"datetime",clearable:""},null,8,["value"])]),_:1}),o(s,{span:12,"rail-style":g,label:"\u662F\u5426\u4E0A\u67B6",path:"online"},{default:r(()=>[o(q,{"rail-style":g,value:t.online,"onUpdate:value":e[3]||(e[3]=a=>t.online=a)},{checked:r(()=>[]),unchecked:r(()=>[]),_:1},8,["value"])]),_:1}),o(s,{span:24,label:"\u6587\u7AE0\u5716\u7247",path:"image"},{default:r(()=>[o(F,{"file-list":t.image,"onUpdate:file-list":e[4]||(e[4]=a=>t.image=a),accept:"image/*",max:1},{default:r(()=>[o(_(f),null,{default:r(()=>[se]),_:1})]),_:1},8,["file-list"])]),_:1}),o(s,{span:24,label:"\u6587\u7AE0\u63CF\u8FF0",path:"description"},{"clear-icon":r(()=>[o(V,{component:n.TrashBinOutline},null,8,["component"])]),default:r(()=>[o(y,{value:t.description,"onUpdate:value":e[5]||(e[5]=a=>t.description=a),placeholder:"Textarea",type:"textarea",round:"",clearable:"",autosize:{minRows:3}},null,8,["value"])]),_:1}),o(s,{span:24,label:"\u6587\u7AE0\u5167\u5BB9",path:"editor"},{default:r(()=>[u("div",null,[o(_(K),{toolbar:"full",content:t.editor,"onUpdate:content":e[6]||(e[6]=a=>t.editor=a),contentType:"html"},null,8,["content"])])]),_:1})]),_:1}),u("div",ue,[u("a",de,[o($,{show:t.show},{default:r(()=>[ce]),_:1},8,["show"])])])]),_:1},8,["model","size","onSubmit"])]),_:1},8,["show"])])}}};export{ve as default};
